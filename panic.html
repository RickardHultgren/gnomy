<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gnomy Countdown with D3.js</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(to bottom right, #1b1c2d, #2a3c4d);
            margin: 0;
            overflow: hidden;
            height: 100vh; /* Center vertically */
        }
        .container {
            width: 400px; 
            height: 400px;
            border: 2px solid #6593a2; 
            position: relative;
            background-color: #645452;
            background-image: url(border.jpg);
            background-repeat: no-repeat;
            background-size: 100% 100%;          
            background-position: center;  
            padding: 2em;
        }
        svg {
            background: #338833;
            background-image: radial-gradient(#224422 1px, transparent 0);
            background-size: 1em 1em;
            background-position: -19px -19px;
            width: 100%;
            height: 100%;
        }
        .countdown {
            font-size: 48px;
            font-weight: bold;
            fill: #ffff00;
        }
        button {
            transition: background-color 0.3s;
            background-color: #6593a2;
            color: white;
            padding: 0.25em;
            border: 2px solid white;
            border-color: #98c6d5;
            border-radius: 0.25em;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div style="display:block;">
    <div style="text-align:left; width:420px; background-color: #645452; border: 10px solid transparent; padding: 15px; border-image: url(border.jpg) 30 stretch;">
        <a href="homescreen.html">
            <button>Home Screen</button>
        </a>
    </div>
    <div id="hud-text" style="height: 3em; width: 100%;"></div>
    <div class="container">
        <svg></svg>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // Set up the SVG container
        const svg = d3.select("svg");

        // Define Gnomy logo properties
        const logoWidth = 50;
        const logoHeight = 50;
        let initialX = 20;
        let initialY = 20;

        // Append Gnomy logo image to the SVG
        const gnomyLogo = svg.append("image")
            .attr("xlink:href", 'GnomyLogo.png') 
            .attr("x", initialX)
            .attr("y", initialY)
            .attr("width", logoWidth)
            .attr("height", logoHeight);

        // Define drag behavior
        const drag = d3.drag()
            .on("start", function () {
                d3.select(this).raise().classed("active", true);
            })
            .on("drag", function (event) {
                d3.select(this)
                    .attr("x", Math.max(0, Math.min(event.x, 600 - logoWidth)))
                    .attr("y", Math.max(0, Math.min(event.y, 600 - logoHeight)));
            })
            .on("end", function () {
                d3.select(this).classed("active", false);
            });

        // Apply the drag behavior to the logo
        gnomyLogo.call(drag);

        // Function to start the first countdown from 4 to 0
        function startFirstCountdown() {
            const countdownText1 = svg.append("text")
                .attr("class", "countdown")
                .attr("x", 300)
                .attr("y", 50)
                .text(4);
            d3.select("#hud-text").text("Inhale");

            let countdownValue1 = 4;
            const countdownInterval1 = setInterval(() => {
                countdownValue1--;
                countdownText1.text(countdownValue1);

                if (countdownValue1 < 1) {
                    clearInterval(countdownInterval1);
                    setTimeout(() => {
                        svg.selectAll(".countdown").remove();
                        startSecondCountdown();
                    }, 1000);
                }
            }, 1000);
        }

        // Function to start the second countdown from 7 to 0
        function startSecondCountdown() {
            const countdownText2 = svg.append("text")
                .attr("class", "countdown")
                .attr("x", 300)
                .attr("y", 300)
                .text(7);
            d3.select("#hud-text").text("Hold Breath");

            let countdownValue2 = 7;
            const countdownInterval2 = setInterval(() => {
                countdownValue2--;
                countdownText2.text(countdownValue2);

                if (countdownValue2 < 1) {
                    clearInterval(countdownInterval2);
                    setTimeout(() => {
                        svg.selectAll(".countdown").remove();
                        startThirdCountdown();
                    }, 1000);
                }
            }, 1000);
        }

        // Function to start the third countdown from 8 to 0
        function startThirdCountdown() {
            const countdownText3 = svg.append("text")
                .attr("class", "countdown")
                .attr("x", 10)
                .attr("y", 50)
                .text(8);
            d3.select("#hud-text").text("Exhale");

            let countdownValue3 = 8;
            const countdownInterval3 = setInterval(() => {
                countdownValue3--;
                countdownText3.text(countdownValue3);

                if (countdownValue3 < 1) {
                    clearInterval(countdownInterval3);
                    setTimeout(() => {
                        svg.selectAll(".countdown").remove();
                        startFirstCountdown();
                    }, 1000);
                }
            }, 1000);
        }

        // Start the countdown loop
        startFirstCountdown();
    </script>
</div>
</body>
</html> 
